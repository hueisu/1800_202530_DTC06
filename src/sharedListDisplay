import { getAuth, onAuthStateChanged } from "firebase/auth";
import { hideLoading, showAlert, showLoading, showModal } from "./general";
import $ from "jquery";
import { auth, db } from "./firebaseConfig";
import {
  formatPrice,
  updateTotalPrice,
  updateCartItemCount,
  addProductCount,
  reduceProductCount,
  editProductCount,
  removeProduct,
} from "./shoppinglist";
import { collection, doc, getDocs } from "firebase/firestore";

async function loadSharedList() {
  const urlParams = new URLSearchParams(window.location.search);
  const ownerID = urlParams.get("owner");
  if (ownerID) {
    console.log("Loading list for owner:", ownerID);
    await getCurrentList(ownerID);
  } else {
    console.error("Error: Owner ID not found or invalid in URL.");
  }
}

async function getCurrentList(ownerID) {
  const currentList = collection(db, "users", ownerID, "currentList");
  try {
    const listSnapshot = await getDocs(currentList);
    if (listSnapshot.empty) {
      showAlert("List is Empty!");
    } //process rendering and display
  } catch (error) {
    console.error("Error fetching list", error);
    showAlert("Failed to load list. Permission denied or error occurred.");
  }
}
